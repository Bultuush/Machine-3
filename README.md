# Machine-3 "Vulnhub Empire: Breakout"
Target-ын мэдэээл авах netdiscover командыг хийснээр бидний зорилтот IP гэж юу болохыг харах боломжтой

![image](https://github.com/Bultuush/Machine-3/assets/129934501/d938ed4a-ecf8-45fa-b12b-a7db43cb3426)

Target-ын IP хаяг **192.168.56.104**

![image](https://github.com/Bultuush/Machine-3/assets/129934501/a81c7031-5ba9-4f42-99e5-6d8500e1ab80)

nmap -sV 192.168.10.13 -sV --> Энэ сонголт нь Nmap-д хувилбар илрүүлэхийг хэлдэг. Мөн онгорхой портыг харуулдаг.
Би IP хаяг нь 192.168.56.26 гэдгийг олж мэдсэн бөгөөд 80, 139, 445, 10000, 20000 портууд нээлттэй байгааг олж мэдсэн.
Дараа нь би ямар нэгэн зүйл олж мэдэхийн тулд вэб програм руу нь орж үзье.

![image](https://github.com/Bultuush/Machine-3/assets/129934501/43759693-cda7-43f5-ac08-6aa3c08d2728)

Миний тааралдсан эхний хуудас бол анхдагч Apache2 хуудас байсан. Хуудас дээр онцлох зүйл байхгүй байсан ч би хуудасны эх сурвалжийг үзээд шифрлэгдсэн мессежийг олсон.

![image](https://github.com/Bultuush/Machine-3/assets/129934501/d4febacf-31f6-4be1-9d12-cc1f83ff8a8c)

Энэ зурвас надад маш их асуудал үүсгэсэн хэсэг байсан. Энэ мессеж нь өөрөө шифрлэгдсэн мессеж нь нууц үг байсан нь тодорхой байсан ч би шифрлэлтийн алгоритмыг таньсангүй. Би мессежийн кодыг тайлах гэж оролдохоосоо өмнө ямар нэгэн нэвтрэх хуудас болон хэрэглэгчийн нэр хайхыг хүссэн.

Миний хийхийг хүссэн дараагийн зүйл бол зорилтот төхөөрөмж дээр нээлттэй байсан SMB-г тоолж чадах эсэхийг харах явдал байв. SMB нь Server Message Block бөгөөд файл хуваалцах протокол юм. **Enum4linux** нь SMB-г тоолох боломжтой командын мөрийн хэрэгсэл юм. Үүнийг ашиглахын тулд та зүгээр л **'enum4linux 192.168.56.104'** гэж бичиж болно.

![image](https://github.com/Bultuush/Machine-3/assets/129934501/f9418f25-3bf3-45fd-b108-0ad23eb61bca)

Мэдээллийг гүйлгэж үзэхэд (маш их зүйл байсан) надад "кибер" гэсэн хэрэглэгчийн нэрийг авсан. Тиймээс энэ үед би хэрэглэгчийн нэр болон шифрлэгдсэн нууц үгтэй байсан.

Дэлгэрэнгүй мэдээлэл авахын тулд би нэмэлт тооллого хийх шаардлагатай болсон. Би бүх протоколуудын үйлчилгээний хувилбаруудыг ажиллуулахын тулд -sV сонголтоор хоёр дахь nmap скан хийсэн.

![image](https://github.com/Bultuush/Machine-3/assets/129934501/a81c7031-5ba9-4f42-99e5-6d8500e1ab80)

HTTP нь зорилтот төхөөрөмж дээр 80, 10000, 20000 портууд дээр ажиллаж байсан. Энэ нь Unix-ийн вэбд суурилсан админ хэрэгсэл болох Webmin-ийг ажиллуулж байсан.

Би бас зочилж болох лавлахууд байгаа эсэхийг шалгахын тулд dirb скан хийсэн боловч энэ нь надад ашигтай зүйл өгсөнгүй.

![image](https://github.com/Bultuush/Machine-3/assets/129934501/17212e5b-8861-41e3-853d-978e4edf932e)

Би 10000 порт дээрх вэб програмд зочилж, нэвтрэх хуудсыг олсон. Би порт 20000-д зочлохдоо ижил нэвтрэх хуудсыг олсон.

![image](https://github.com/Bultuush/Machine-3/assets/129934501/91774487-7255-41d7-a51c-b632f26f912c)

Нэвтрэх хуудас болон хэрэглэгчийн нэр хоёулаа байсан тул би мессежийн кодыг тайлахыг оролдсон цаг байсан. Энэ бол шифрлэлтийг танихгүй байсан тул надад хамгийн их бэрхшээл учруулсан хэсэг байсан. Би үнэхээр гацсан байсан тул энэ хэсгийг ойлгохын тулд өөр нэг алхам хайсан.

Алгоритм нь шифрлэлтийн алгоритм биш, харин **Brainfuck** хэмээх **эзотерик** програмчлалын хэл байсныг би олж мэдсэн. Эзотерик програмчлалын хэл бол миний олж мэдсэнээр ойлгоход зориудаар хэцүү програмчлалын хэл юм. Хэрэв та энэ талаар илүү ихийг уншихыг хүсвэл би энэ бичвэр, зааварчилгааг олсон.

![image](https://github.com/Bultuush/Machine-3/assets/129934501/b1ac4c59-d67b-487e-a592-ff503b4c33d2)

192.168.56.26:20000 руу буцаж очоод бүх мэдээллээ оруулаад системд орсон.

![image](https://github.com/Bultuush/Machine-3/assets/129934501/3f68c851-63bf-494e-8714-ab9cd3f9f748)

Би интерфэйсийг тойруулан үзээд нэвтрэх доор тушаалын бүрхүүл оллоо. Би whoami, id, ls гэж гүйгээд эхний flag оллоо.

![image](https://github.com/Bultuush/Machine-3/assets/129934501/ce496b77-0ba1-49bf-8ce7-de6c15507844)

![image](https://github.com/Bultuush/Machine-3/assets/129934501/a3c707a4-4487-423b-963c-924ad08e67ed)

Би үүнийг reverse shell ашигласан. Би Кали машин дээрээ netcat сонсогч суулгасан бөгөөд сонсогчтой холбогдохын тулд хохирогчийн командын бүрхүүл дээр nc ашигласан. Тэгээд би TTY Shell-ийг төрүүлснээр өөртөө арай илүү хяналт тавьж өгсөн.

![image](https://github.com/Bultuush/Machine-3/assets/129934501/dc9c056c-f86f-43e8-83e7-d28cc10402cd)

![image](https://github.com/Bultuush/Machine-3/assets/129934501/f523ef9e-8f5f-4ee3-8c80-7d7fc0fc52f0)

Дараагийн алхам бол хоёр дахь тугийг авахын тулд үндсэн хэрэглэгч рүү очих явдал байв. Би sudo хэрэглэгчийн хувьд ямар командуудыг ажиллуулах боломжтойг харахын тулд sudo -l гэж гүйсэн боловч sudo команд олдсонгүй.

![image](https://github.com/Bultuush/Machine-3/assets/129934501/92dbd7a4-db1e-45ec-845b-0f281018b6af)

Дараа нь би **'find / -perm -u=s -type f 2>/dev/null'**-г ажиллуулж миний ашиглаж болох хоёртын файл байгаа эсэхийг шалгасан боловч энэ нь надад тийм ч их зүйл өгсөнгүй.

![image](https://github.com/Bultuush/Machine-3/assets/129934501/00145368-39b8-4515-bfa3-8b3b63e129a7)

Би бас /etc/shadow файлыг нээж чадах эсэхийг шалгахыг оролдсон боловч бас татгалзсан.

Киберийн гэрийн лавлахад 'tar' гэж нэрлэгддэг хоёртын файл байдаг. Би машин дээр tar команд байгаа эсэхийг мэдэхийн тулд "whereis tar" гэж гүйлгэсэн. Энэ нь байсан бөгөөд цааш нь шалгахад гэрийн лавлах дахь хоёртын файл нь зөвхөн tar команд болохыг олж мэдсэн. Би нэмэлт мэдээлэл авахын тулд хоёртын файл дээр getcap командыг ашигласан.

![image](https://github.com/Bultuush/Machine-3/assets/129934501/552b1097-cd8d-4c52-b80c-0048dfc94aa7)

Би үүнийг үндсэндээ ямар ч файл уншихад ашиглаж болно гэдгийг олж мэдсэн. Би эхлээд /etc/shadow файлыг авах гэж оролдсон. Би Жон Рипер ашиглан нууц үгээ тайлахыг хүссэн. Гэсэн хэдий ч надад нууц үг агуулагдсан үгийн жагсаалт байхгүй байсан тул энэ нь ажиллахгүй байсан. Би ямар нэг зүйл олохын тулд машиныг тойруулан харахаар шийдэв.

Дараагийн хэсэг нь удаан үргэлжилсэн ч би эцэст нь /var/backups лавлахаас ямар нэгэн зүйл олсон. old_pass.bak гэсэн далд файл байсан. Би тэр файлын агуулгыг авахын тулд tar хоёртын файлыг ашигласан.

![image](https://github.com/Bultuush/Machine-3/assets/129934501/2e7d84b9-2703-43b6-afef-34882df0c498)

Энэ нь root password байсан. Би үүнийг ашиглан root руу шилжиж, үндсэн лавлах руу орж, эцсийн туг авсан.

![image](https://github.com/Bultuush/Machine-3/assets/129934501/8b536b93-c448-434b-91cf-7d59709f3b05)
